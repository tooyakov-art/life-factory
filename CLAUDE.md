# Life Factory — Операционная система жизни

## Описание
Визуальный редактор бизнес-процессов в стиле Factorio.
Пользователь видит свою жизнь и бизнес как фабрику с конвейерами.

## Стек
- Next.js 16 + TypeScript + Tailwind CSS
- @xyflow/react для графов
- Zustand для стейта
- PWA для мобильного

## Хранение: локальные JSON файлы в schemas/
- Каждая схема = отдельный .json файл в папке schemas/
- API роуты: GET/POST /api/schemas, GET/PUT/DELETE /api/schemas/[name]
- Автосохранение: debounce 2 секунды + интервал 30 секунд
- Файлы видны в проводнике, открываются в VS Code, хранятся в git
- Как Obsidian — просто файлы, работает без интернета

## Запуск
- npm run dev — дев-сервер
- npm run build — билд
- npm run lint — линтер

## Правила
- TypeScript строго, без any
- Компоненты функциональные
- Tailwind для стилей, НИКАКИХ css файлов (кроме globals.css)
- Мобиль-first дизайн, всё должно работать на телефоне
- Тёмная тема: bg-slate-900, text-slate-100
- Русский язык в интерфейсе
- Комментарии в коде на русском
- Перед созданием файла ищи существующий через Grep
- НИКОГДА не удаляй файлы без подтверждения

## Цветовая схема узлов
- Зелёный #22c55e — входящий поток (клиенты, лиды)
- Синий #3b82f6 — процессы (AI, код, работа)
- Жёлтый #f59e0b — продажи и переговоры
- Изумрудный #10b981 — деньги
- Красный #ef4444 — проблемы и узкие горлышки
- Фиолетовый #8b5cf6 — контент и маркетинг
- Розовый #ec4899 — шаблоны и автоматизация
- Оранжевый #f97316 — рефералы

## Анимации
- Связи между узлами: анимированные шарики бегут от входа к выходу
- Скорость шариков = объём потока (больше клиентов = быстрее)
- Узкое горлышко: красная пульсация + замедление шариков
- Новый узел: появляется с scale анимацией

## Структура проекта
- src/types/factory.ts — все типы данных
- src/store/ — Zustand stores (useFactoryStore, useAlertStore)
- src/components/factory/ — компоненты редактора (Canvas, NodeTypes, EdgeTypes, Toolbar, Palette)
- src/components/dashboard/ — компоненты главной страницы
- src/utils/ — утилиты (bottleneck, metrics, templates)
- src/app/page.tsx — главная (дашборд)
- src/app/factory/[id]/page.tsx — редактор схемы

## КАЙДЗЕН — система непрерывного улучшения

### После КАЖДОГО изменения в коде:
1. npm run build — если ошибки, почини ВСЕ до единой
2. Открой в браузере — проверь что ничего не сломалось
3. Если нашёл баг — почини СРАЗУ, не откладывай
4. git commit с описанием что улучшил

### После КАЖДОГО коммита спроси себя:
- Какой файл самый грязный? → Отрефактори
- Какой компонент дублируется? → Вынеси в общий
- Какой код непонятен через неделю? → Добавь комментарий

### CHANGELOG.md — обновляй ВСЕГДА:
Формат:
## v0.X.X — дата
- fix: что починил
- improve: что улучшил
- learn: что узнал (ОБЯЗАТЕЛЬНО)

### НИКОГДА не делай больше 1 фичи за раз
Одна фича → build → проверка → commit → следующая.
